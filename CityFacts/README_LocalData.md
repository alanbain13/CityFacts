# CityFacts Local Data Integration

This document explains how to integrate the JSON data generated by the Python data populator into the iOS CityFacts app.

## Overview

The app now supports two data modes:
- **Local Mode**: Uses pre-populated JSON data from OpenTripMap/OpenStreetMap
- **Premium Mode**: Uses Google Places API for real-time data

## Setup Instructions

### 1. Generate JSON Data

First, run the Python data populator to generate JSON files:

```bash
cd /path/to/CityFactsDataPopulator
python main.py
```

This will create:
- `cities.json`
- `attractions.json` 
- `hotels.json`

### 2. Add JSON Files to iOS App

1. Copy the generated JSON files to your iOS project
2. Add them to your Xcode project bundle:
   - Drag the JSON files into your Xcode project
   - Make sure "Add to target" is checked for your app target
   - The files should appear in your app bundle

### 3. Test the Integration

Use the `LocalDataTestView` to test the local data loading:

```swift
// In your ContentView or main navigation
LocalDataTestView()
```

## Architecture

### Service Abstraction

The app uses a service abstraction pattern:

```swift
protocol PlacesServiceProtocol {
    func searchAttractions(near location: CLLocationCoordinate2D, radius: Double) async throws -> [Attraction]
    func searchHotels(near location: CLLocationCoordinate2D, radius: Double) async throws -> [Hotel]
    func getAttractions(for cityId: String) -> [Attraction]
    func getHotels(for cityId: String) -> [Hotel]
}
```

### Services

- **LocalDataService**: Loads data from JSON files
- **GooglePlacesService**: Fetches data from Google Places API
- **PlacesServiceFactory**: Creates the appropriate service based on user type

### Usage

```swift
// Create CityStore with local data
let cityStore = CityStore(isPremiumUser: false)

// Switch to premium mode
cityStore.switchToPremium()

// Get attractions for a city
let attractions = await cityStore.getAttractions(for: city)
let hotels = await cityStore.getHotels(for: city)
```

## Data Flow

1. **Local Mode**: 
   - JSON files are loaded at app startup
   - Data is converted to Swift models
   - No network calls required

2. **Premium Mode**:
   - Google Places API calls are made on demand
   - Real-time data with photos and detailed information
   - Requires API key and internet connection

## Benefits

- **Cost Reduction**: Local data eliminates Google Places API costs
- **Offline Support**: App works without internet connection
- **Faster Loading**: No network delays for local data
- **Flexible**: Easy to switch between local and premium modes

## Next Steps

1. Add the JSON files to your app bundle
2. Test with `LocalDataTestView`
3. Integrate the service abstraction into existing views
4. Add user preference for local vs premium mode
5. Implement data refresh mechanisms for local data 